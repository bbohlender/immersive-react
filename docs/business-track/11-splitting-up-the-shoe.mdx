---
title: Splitting up the Shoe
description:
nav: 11
---

We begin our Shoe Configurator by loading the shoe model and splitting it into parts using gltf.pmnd.rs, so we can declaratively control them individually.  

<Sandpack
  template="react-ts"
  customSetup={{
    dependencies: {
      'three': '~0.168.0',
      '@react-three/fiber': 'latest',
      '@react-three/drei': 'latest',
      '@react-three/xr': 'latest',
    },
  }}
  files={{
    '/App.tsx': `import { Canvas, useFrame } from "@react-three/fiber";
import { useState, useRef } from "react";
import { useGLTF, Environment } from "@react-three/drei";
import { createXRStore, XR } from "@react-three/xr";

const store = createXRStore({ emulate: { inject: true } });

export default function App() {
  return (<>
    <button style={{ position: "absolute", zIndex: "1" }} onClick={() => store.enterVR()}>
        Enter VR
    </button>
    <Canvas style={{ position: "absolute", inset: "0", touchAction: "none" }}>
      <XR store={store}>
        <Environment preset="warehouse" />
        <MyComponent />
        <MyModel />
      </XR>
    </Canvas>
    </>
  )
}

function MyModel() {
    const { scene } = useGLTF("https://www.immersive-react.com/shoe.glb")
    return <primitive object={scene} />
}

function MyComponent() {
    const [red, setRed] = useState(true)
    const ref = useRef<Mesh>(null)
    useFrame(() => ref.current?.rotateY(0.01)) 
    return <mesh ref={ref} onClick={() => setRed(!red)} position={[ 0, 0, 0 ]}>
        <boxGeometry/>
        <meshBasicMaterial color={red ? "red" : "blue"} />
    </mesh>
}

`, 'model.tsx': ``}}/>

Let's first, remove the `MyComponent` and `MyModel` components and their usage inside of the `Canvas`. Next, download the <a download href="https://www.immersive-react.com/shoe.glb">shoe.glb</a> model and drag it into [gltf.pmnd.rs](gltf.pmnd.rs). Once the model is uploaded, switch on the types option in the right-hand panel. Copy the output generated by gltf.pmnd.rs, paste it into the `model.tsx` file, and replace the `shoe.glb` URL with `https://www.immersive-react.com/shoe.glb` both in `useGLTF` and in `useGLTF.preload` at the end. Also, remove the `castShadow` and `receiveShadow` properties from the model to simplify the rendering setup.

Now add a `Model` import into our `App.tsx` and add a instance of the `Model` component inside the `XR` tag. With this setup, we have a declaratively delcared shoe rendered in our 3D app.


Next, we create the InteractableMesh component to make each part of the shoe individually interactable. The component returns a mesh with geometry and material attributes provided through the InteractableMesh properties. Additionally, we add a `useState` hook for the boolean `red` state. We add an `onClick` handler to toggle the `red` state.

Lastly, we replace all mesh tags inside the `Model` component with `InteractableMesh` tags while keeping the geometry and material properties.

